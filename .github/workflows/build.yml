name: Windows Build

on:
  push:
  pull_request:

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      # Download prebuilt Qt (MSVC 64-bit)
      # Example uses Qt 6.6.0 â€” adjust if needed
      - name: Download Qt
        run: |
          curl -L -o qt.zip https://download.qt.io/official_releases/qt/6.6/6.6.0/submodules/qtbase-everywhere-src-6.6.0.zip
          mkdir qt
          tar -xf qt.zip -C qt

      # Download prebuilt OpenCV for Windows
      - name: Download OpenCV
        run: |
          curl -L -o opencv.zip https://github.com/opencv/opencv/releases/download/4.9.0/opencv-4.9.0-windows.zip
          mkdir opencv
          tar -xf opencv.zip -C opencv

      # Configure CMake
      - name: Configure CMake
        run: >
          cmake -B build -S Pebble
          -DCMAKE_BUILD_TYPE=Release
          -DQt6_DIR="${{ github.workspace }}\qt\qtbase-everywhere-src-6.6.0"
          -DOpenCV_DIR="${{ github.workspace }}\opencv\opencv\build"

      # Build
      - name: Build
        run: cmake --build build --config Release
